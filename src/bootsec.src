** BOOT-LOADER FUER FAT16.COM*PTR1	EQU 2PTR2	EQU 4*SECCNT0	EQU $C4DIRCNT	EQU $C5*COPEN	EQU 3CCLOSE	EQU 12CBPUT	EQU 11ICCOM	EQU $342ICADRL	EQU $344ICADRH	EQU $345ICLENL	EQU $348ICLENH	EQU $349ICAUX1	EQU $34AICAUX2	EQU $34B*CIOV	EQU $E456*COLBAK	EQU $D01AWSYNC	EQU $D40AVCOUNT	EQU $D40B** PAGE 3*DDEVIC   EQU $0300DUNIT    EQU $0301DCOMND   EQU $0302DSTATS   EQU $0303DBUFLO   EQU $0304DBUFHI   EQU $0305DTIMLO   EQU $0306DUNUSE   EQU $0307DBYTLO   EQU $0308DBYTHI   EQU $0309DAUX1    EQU $030ADAUX2    EQU $030BPTR	EQU $0SAVMSC	EQU $58SIOV	EQU $E459DSKINV	EQU $E453EOUTCH	EQU $F2B0PORTB	EQU $D301NMIEN	EQU $D40EDIRSEC	EQU $169		-$170BUFFER	EQU $0480SECLEN	EQU BUFFER+127DOSINIT	EQU $D00***	ORG $AA00LOOP1	LDA VCOUNT	STA WSYNC	STA COLBAK	JMP LOOP1*	ORG $600*	LDX #1	STX DAUX1	DEX	STX DAUX2	LDA #$A800:L	STA DBUFLO	LDA #$A800:H	STA DBUFHI	JSR PUTSEC	INC DAUX1	LDA DBUFLO	ORA #128	STA DBUFLO	JSR PUTSEC	INC DAUX1	LDA #0	STA DBUFLO	INC DBUFHI	JSR PUTSEC	RTSPUTSEC	LDA #'P	STA DCOMND	LDA #2	STA DUNIT	JSR DSKINV	BMI ERR	RTSERR	BRK*	ORG $700,$A800*	ORG $A800*	JMP LOADER*BOOTTAB	DFB 0SECCNT	DFB 3LADDR	DFW $0700	LOAD ADDR	DFW DOSINITLOADER	LDA #8	STA SECCNT0	LDA #DIRSEC:L	STA DAUX1	LDA #DIRSEC:H	STA DAUX2	FDIR5	JSR GETSEC	LDX #0FDIR3	LDA BUFFER,X	BEQ ERROR	CMP #$42	BNE FDIR1	LDA BUFFER+1,X	STA PTR2	LDA BUFFER+2,X	STA PTR2+1	LDA BUFFER+3,X	STA DAUX1	LDA BUFFER+4,X	STA DAUX2	LDY #0FDIR6	LDA FNAME,Y	CMP BUFFER+5,X	BNE FDIR1	INX	INY	CPY #10	BNE FDIR6	BEQ READFILFDIR1	TXA	CLC	AND #$F0	ADC #16	TAX	BPL FDIR3FDIR2	DEC SECCNT0	BEQ ERROR	INC DAUX1	BNE FDIR5ERROR	BRK*GETSEC	LDA #'R	STA DCOMND	LDA #1	STA DUNIT	LDA #BUFFER:L	STA DBUFLO	LDA #BUFFER:H	STA DBUFHI	JSR DSKINV	BMI ERROR	RTS***READFIL	LDA #BUFFER:L	STA PTR	LDA #BUFFER:H	STA PTR+1	JSR INCY1READCHU	CPY SECLEN	BNE READCHU1	LDA PTR2	ORA PTR2+1	BNE READCHU2	CLC*	TAY	RTSREADCHU2	LDY #124	JSR INCYREADCHU1	LDA #$FF	CMP (PTR),Y	BNE READFI1	JSR INCY	CMP (PTR),Y	BNE READFI1	JSR INCYREADFI1	LDA (PTR),Y	STA TOADR+1	JSR INCY	LDA (PTR),Y	STA TOADR+2	JSR INCY	LDA (PTR),Y	STA PTR1	JSR INCY	LDA (PTR),Y	STA PTR1+1	JSR INCYREADFI4	LDA (PTR),YTOADR	STA $FFFF	JSR INCYREADFI2	LDA TOADR+1	CMP PTR1	BNE READFI3	LDA TOADR+2	CMP PTR1+1	BNE READFI3	BEQ READCHUREADFI3	INC TOADR+1	BNE READFI4	INC TOADR+2	BNE READFI4***INCY	INY	CPY #125	BNE INCY9	LDA (PTR),Y	AND #3	STA DAUX2	INY	LDA (PTR),Y	STA DAUX1	INCY1	JSR GETSEC	SEC	LDA PTR2	SBC #1	STA PTR2	BCS INCY8	DEC PTR2+1INCY8	LDY #0INCY9	RTS*FNAME	ASC "FAT16   COM"*